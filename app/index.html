<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CCL-5</title>
    <link rel="stylesheet" type="text/css" href="./styles/main.css">
  </head>
  <body>
    <div class="scripts">
      <script src="./socket.io/socket.io.js"></script>
      <script src="./third-party/two.js"></script>
      <script src="./src/graph.js"></script>
      <script>

        var two = new Two({
          fullscreen: true,
          autostart: true
        }).appendTo(document.body);

        var graph = new Graph()
          .appendTo(document.body);

        var temp = new Two.Vector();

        var velocity = {
          x: 0,
          y: 0,
          z: 0
        };

        graph
          .addChannel('x', 'blue')
          .addChannel('y', 'green')
          .addChannel('z', 'red')
          .bind('listening', function() {
            document.body.style.background = 'blue';
            console.log('listening');
          })
          .bind('responding', function() {
            document.body.style.background = 'red';
            console.log('responding');
            // setTimeout(function() {
            //   graph.trigger('listen');
            // }, graph.lag);
          });

        var socket = io.connect('http://localhost:8080');
        socket
          .on('connect', function() {

            console.log('Connected to device.');

          })
          .on('message', function(resp) {

            var data = JSON.parse(resp);
            graph.update(data.acceleration);

          })
          .on('ended', function() {

            console.log('Disconnected from device.');

          })
          .emit('restart');



      </script>
    </div>
  </body>
</html>